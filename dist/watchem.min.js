/**
 *  A very simple, one file script to watches for .js & .css files present in DOM
 *  over AJAX and reload the page or style when changes are detected.
 *
 *  @license MIT
 *  @version 0.7.0
 *  @author Dumitru Uzun (DUzun.Me)
 */
!function(e,t){var n,r,a,o,i="https://unpkg.com/jajax.js",c=e.document,f=e.location,s=e.localStorage,d=e.setTimeout,u=e.clearTimeout,h=e.JSON,l=f.hostname,p=f.origin,v=[],m={},g={},w={},y=v.slice,j=c.createElement("a"),S=new RegExp("(\\?|\\&)_w_=[^\\&]+"),x={interval:700,reDOM:7e3,wDoc:!0,wCSS:!0,wJS:!0,noMin:!0,hostAlias:{},wHosts:[l],defMethod:"HEAD",altMethod:"GET",headers:{"X-Requested-With":"Watchem"}},O={list:v,extern:m,states:g,types:w,options:x,stopped:t,stop:function(){r&&u(r),r=t,O.stopped=R(),s&&(s.watchemStopped=O.stopped)},start:function(e){O.stopped?(delete O.stopped,s&&delete s.watchemStopped,M(e)):A(e)},init:M,run:A,watch:b,setOption:C,saveOptions:N,loadOptions:H,debug:G},E=e.jajax||((o=e.jQuery||e.Zepto)&&o.ajax||(G("Loading ",i),function(e,n){var r=c.createElement("SCRIPT");r.async=1,r.src=e;var a=c.getElementsByTagName("script")[0];r.onload=r.onreadystatechange=function(e){!r||(a=r.readyState)&&"loaded"!=a&&"complete"!=a||r&&(n&&n.call(r,e),r.parentNode&&r.parentNode.removeChild(r),r=t)},a.parentNode.insertBefore(r,a)}(i,(function(){d((function(){e.jajax&&(E=e.jajax)}),16)}))),function(e,t,n){if(!o||!o.ajax)throw new Error("Watchem: no jAJAX, jQuery or Zepto found!");return o.ajax(e).done(t).fail(n)});function M(o){a&&u(a),s&&(r==t?H():O.stopped=+s.watchemStopped||!1),j.href=p;var i=[];x.wCSS&&(i=i.concat(J().map(I).filter(k))),x.wJS&&(i=i.concat(y.call(c.scripts||c.querySelectorAll("script[src]")).map(I).filter(k))),x.wDoc&&i.push(q(f)),b(i),o&&!o.type&&b(o,!0);var h=e.watchemToo;return h&&b(h,!0),n=0,a=x.reDOM&&d(M,x.reDOM),T(x.interval),O}function b(e,t){function n(e,n,r){r&&(G("tracking ",e,': "'+(n+"").replace(/[\r\n]+/g," ").substr(0,64)+'"'),t&&(m[e]=!0))}e&&("string"==typeof e&&(e=[e]),Array.isArray(e)?e.forEach((function(e){var t=W(e);t&&Z(t,n)})):Object.keys(e).forEach((function(t){var r=W(t);r?e[t]?Z(r,n):g[r]=!1:delete e[t]})))}function A(e){if(e&&b(e,!0),!v.length)return T(x.interval<<1);var t=n,r=v[t];D(w[r]||x.defMethod,r,(function(e,a,o){var i=x.interval,c=Q(o,e);if(g[r]!=c){var f=_(r);if(G("change detected in ".concat(r,': "').concat(g[r],'" != "').concat(c,'"')),"css"!=f)return L(m[r]?i:0),void(i=0);var s=J(r);if(s.length){var d=s.pop();(d.ownerNode||d).href=B(d.href),g[r]=c}else L()}else n===t&&(++n>=v.length?n=0:i=4);T(i)}),(function(e,t){O.stopped||L()}))}function T(e){return r&&u(r),r=!O.stopped&&e&&d(A,e)}function D(e,t,n,r){return E({url:B(t,e),method:e,headers:x.headers,dataType:"text"},n,r)}function L(e){e?d(L.bind(t,0)):f.reload()}function C(e,n,r){n===t&&"string"!=typeof e?Object.assign(x,e):x[e]=n,r&&N()}function N(){s&&(s.watchem=h.stringify(x))}function H(){if(s){O.stopped=+s.watchemStopped||!1;var e=s.watchem;(e=e&&h.parse(e))&&C(e)}}function R(){return Date.now()}function k(e){return e}function J(e){for(var t,n=y.call(c.styleSheets||c.querySelectorAll("link[rel=stylesheet][href]")),r=[],a=0;a<n.length;a++)(t=n[a]).href?r.push(t):(t=t.cssRules)&&(n=n.concat(y.call(t)));if(e){j.hostname=l,j.href=e,e=j.href;var o=j.hostname,i=j.pathname,f=j.search,s=[o],d=x.hostAlias,u=d[o];u&&s.push(u),r=r.filter((function(e){var t=e.href;if(t&&(j.href=t,j.pathname==i&&(!f||j.search==f))){var n=j.hostname;if(!~s.indexOf(n)){var r=d[n];if(!r||!~s.indexOf(r))return}return!0}}))}return r}function _(e){return j.href=e,j.pathname.split(".").pop()}function q(e,t){return(t?e.origin:"")+e.pathname+e.search.replace(S,"")}function W(e,n){if(j.href=p,j.href=e,n==t){var r=x.hostAlias,a=j.hostname,o=r&&r[a];n=a!=l&&(!o||o!=l)}return q(j,n)}function B(e,t){var n=e.replace(S,"");return t&&"HEAD"!=t||(n+=(n.indexOf("?")<0?"?":"&")+"_w_="+(4194303&R()).toString(36)),n}function I(e){var n=e.src||e.href;if(n){var r=_(n),a=x.wHosts,o=x.hostAlias,i=j.hostname,c=o&&o[i];if((!a||!a.length||-1!=a.indexOf(i)||c&&-1!=a.indexOf(c))&&!(x.noMin&&j.pathname.indexOf(".min.")>0))return".css.js".indexOf(r)>-1&&-1==j.pathname.indexOf("/jasmine/lib/")?q(j,i!=l&&(!c||c!=l)):t}}function Q(e,t){if(e){var n,r,a,o=["Content-Type","Content-Length","Last-Modified","ETag"],i=[];for(n=o.length;n--;)if(a=e.getResponseHeader(r=o[n])){if("ETag"==r)return a;"Last-Modified"==r&&(a=(new Date(a)/1e3).toString(36)),i[n]=a}if(i.length)return i.join("~")}return t}function X(e,t,n){var r=e in g;return r||v.push(e),n&&(w[e]=n),g[e]=t,!r}function Z(e,t){if(e)return e in g?void 0:D(x.defMethod,e,(function(n,r,a){var o=Q(a,n);o?t(e,o,X(e,o)):D(x.altMethod,e,(function(n,r,a){var o=Q(a,n);t(e,o,X(e,o,x.altMethod))}))}))}function G(){var t=e.console;if(t&&t.debug)return(G=O.debug=t.debug.bind(t)).apply(t,arguments)}if(M.version="0.7.0","function"==typeof define&&define.amd)M.watchem=O,define([],M);else{a=d(M,x.interval),c.addEventListener&&(c.addEventListener("DOMContentLoaded",M),e.addEventListener("load",M)),e.watchem=O;var P=e.watchemInit;P&&P(O,x)}}("undefined"!=typeof globalThis?globalThis:window);
//# sourceMappingURL=watchem.min.js.map
