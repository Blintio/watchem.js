/*
 MIT
  @author Dumitru Uzun (DUzun.Me)

*/
(function(e,q){function r(){function a(d,a){d in f||(z("tracking ",d,"-",(a+"").replace(/[\r\n]+/g," ").substr(0,32)),s.push(d),g[d]&&(A[d]=!0));f[d]=a}h&&clearTimeout(h);t&&clearTimeout(t);c.href=n.href;var b=B.call(k.scripts||k.querySelectorAll("script[src]")).map(C).filter(function(a){return a});M&&(b=b.concat(D().map(C).filter(function(a){return a})));N&&b.push(n.pathname+n.search.replace(u,""));var l=e.watchemToo,g={};l&&Object.keys(l).forEach(function(a){c.href=a;if(c.hostname!=E)delete l[a];
else{var w=c.pathname+c.search.replace(u,"");l[a]?(b.push(w),g[w]=!0):f[w]=!1}});b.forEach(function(d){d&&(d in f||x({url:d,type:F},function(b,l,c){(b=y(c,b))?a(d,b):x({url:d,type:G},function(b,l,c){b=y(c,b);H[d]=G;a(d,b)})}))});m=0;h=p&&setTimeout(I,p);t=J&&setTimeout(r,J);return f}function I(){var a=m,b=s[a];x({url:b,type:H[b]||F},function(c,g,d){g=p;c=y(d,c);if(f[b]!=c)if(z("change detected in ",b),"css"==K(b))if(d=D(b),d.length){d=d.pop();var e=d.href.replace(u,"");(d.ownerNode||d).href=e+(0>
e.indexOf("?")?"?":"&")+L+"="+(Date.now()||(new Date).getTime());f[b]=c}else v();else{v(A[b]?p:0);return}else m===a&&(++m,m>=s.length?m=0:g=4);h&&clearTimeout(h);h=g&&setTimeout(I,g)},function(a,b){v()})}function v(a){a?setTimeout(v.bind(q,0)):n.reload()}function D(a){var b=B.call(k.styleSheets||k.querySelectorAll("link[rel=stylesheet][href]"));a&&(c.href=a,a=c.href,b=b.filter(function(b){return(b=b.href)&&0==b.indexOf(a)}));return b}function K(a){c.href=a;return c.pathname.split(".").pop()}function C(a){a=
a.src||a.href;if(!a)return q;a=K(a);if(c.hostname!=E)return q;if(!(O&&0<c.pathname.indexOf(".min.")))return-1<".css.js".indexOf(a)&&-1==c.pathname.indexOf("/jasmine/lib/")?c.pathname+c.search.replace(u,""):q}function y(a,b){return a&&(a.getResponseHeader("ETag")||a.getResponseHeader("Last-Modified"))||b}function z(){return e.console&&console.debug&&console.debug.apply(console,arguments)}var p=500,J=5E3,N=!0,M=!0,O=!0,F="HEAD",G="GET",L="_w_",k=e.document,n=e.location,E=n.hostname,s=[],A={},f={},H=
{},B=s.slice,c=k.createElement("a"),u=RegExp("(\\?|\\&)"+L+"=[^\\&]+"),m,h,t,x=e.jajax||function(a){return function(b,c,e){return a.ajax(b).done(c).fail(e)}}(e.jQuery||e.Zepto);"function"==typeof define&&define.amd?define([],r):(t=setTimeout(r,p),k.addEventListener("DOMContentLoaded",r))})(this);
