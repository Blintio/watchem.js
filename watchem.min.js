/*
 MIT
  @author Dumitru Uzun (DUzun.Me)

*/
(function(f,p){function q(){function a(a,b){a in g||(x("tracking ",a,"-",(b+"").replace(/[\r\n]+/g," ").substr(0,32)),r.push(a),y[a]&&(z[a]=!0));g[a]=b}h&&clearTimeout(h);s&&clearTimeout(s);c.href=m.href;var b=A.call(k.scripts||k.querySelectorAll("script[src]")).map(B).filter(function(a){return a});M&&(b=b.concat(C().map(B).filter(function(a){return a})));N&&b.push(m.pathname+m.search.replace(t,""));var e=f.watchemToo,y={};e&&Object.keys(e).forEach(function(a){c.href=a;if(c.hostname!=D)delete e[a];
else{var d=c.pathname+c.search.replace(t,"");e[a]?(b.push(d),y[d]=!0):g[d]=!1}});b.forEach(function(b){b&&(b in g||v({url:b,type:E},function(d,c,e){(d=w(e,d))?a(b,d):v({url:b,type:F},function(d,c,e){d=w(e,d);G[b]=F;a(b,d)})}))});l=0;h=n&&setTimeout(H,n);s=I&&setTimeout(q,I);return g}function H(){var a=l,b=r[a],c=G[b]||E;v({url:J(b),type:c},function(c,e,d){e=n;c=w(d,c);if(g[b]!=c)if(x("change detected in ",b),"css"==K(b))d=C(b),d.length?(d=d.pop(),(d.ownerNode||d).href=J(d.href),g[b]=c):u();else{u(z[b]?
n:0);return}else l===a&&(++l,l>=r.length?l=0:e=4);h&&clearTimeout(h);h=e&&setTimeout(H,e)},function(a,b){u()})}function u(a){a?setTimeout(u.bind(p,0)):m.reload()}function C(a){var b=A.call(k.styleSheets||k.querySelectorAll("link[rel=stylesheet][href]"));a&&(c.href=a,a=c.href,b=b.filter(function(b){return(b=b.href)&&0==b.indexOf(a)}));return b}function K(a){c.href=a;return c.pathname.split(".").pop()}function J(a){a=a.replace(t,"");return a+(0>a.indexOf("?")?"?":"&")+L+"="+((Date.now()||(new Date).getTime())&
4194303).toString(36)}function B(a){a=a.src||a.href;if(!a)return p;a=K(a);if(c.hostname!=D)return p;if(!(O&&0<c.pathname.indexOf(".min.")))return-1<".css.js".indexOf(a)&&-1==c.pathname.indexOf("/jasmine/lib/")?c.pathname+c.search.replace(t,""):p}function w(a,b){return a&&(a.getResponseHeader("ETag")||a.getResponseHeader("Last-Modified"))||b}function x(){return f.console&&console.debug&&console.debug.apply(console,arguments)}var n=500,I=5E3,N=!0,M=!0,O=!0,E="HEAD",F="GET",L="_w_",k=f.document,m=f.location,
D=m.hostname,r=[],z={},g={},G={},A=r.slice,c=k.createElement("a"),t=RegExp("(\\?|\\&)"+L+"=[^\\&]+"),l,h,s,v=f.jajax||function(a){return function(b,c,f){return a.ajax(b).done(c).fail(f)}}(f.jQuery||f.Zepto);"function"==typeof define&&define.amd?define([],q):(s=setTimeout(q,n),k.addEventListener("DOMContentLoaded",q))})(this);
